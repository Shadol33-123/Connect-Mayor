import{b as g,r as l,j as e,L as M,B as C,s as P}from"./index-DNQbeVAn.js";import{C as c,a as B}from"./Card-BcRLNdqC.js";import{g as T}from"./progress-9FMsTnHQ.js";import{P as E}from"./ProgressBar-DsJwVye4.js";function F(){const{data:i,isLoading:$,error:q}=g({queryKey:["lessons"],queryFn:async()=>{const{data:s,error:t}=await P.from("lessons").select("id,title,description,xp,level").order("order_index");if(t)throw t;return s}}),h=g({queryKey:["progress"],queryFn:()=>T()}),[j,f]=l.useState({basico:!0,medio:!1,experto:!1}),N=s=>f(t=>({...t,[s]:!t[s]})),x=l.useMemo(()=>{var s;return new Set(((s=h.data)==null?void 0:s.map(t=>t.lesson_id))||[])},[h.data]),d=l.useMemo(()=>{const s={basico:[],medio:[],experto:[]};return i==null||i.forEach(t=>{t.level&&s[t.level].push(t)}),s},[i]),v=l.useMemo(()=>{const s=(t,a,r,m,y)=>{const n=d[t],w=n.reduce((p,L)=>p+L.xp,0),u=n.filter(p=>x.has(p.id)).length,k=n.length?Math.round(u/n.length*100):0;return{id:t,title:a,description:r,topics:0,lessons:n.length,xpTotal:w,gradient:m,icon:y,completed:u,percent:k}};return[s("basico","Nivel BÃ¡sico","Fundamentos esenciales para usar una computadora","from-emerald-400 to-green-500","ðŸŒ±"),s("medio","Nivel Medio","Habilidades intermedias para ser mÃ¡s productivo","from-indigo-500 to-blue-500","ðŸš€"),s("experto","Nivel Avanzado","Dominio completo y tÃ©cnicas avanzadas","from-pink-500 to-violet-500","ðŸŽ¯")]},[d,x]),o=l.useMemo(()=>({niveles:3,temas:12,lecciones:(i==null?void 0:i.length)||0,xp:(i==null?void 0:i.reduce((s,t)=>s+t.xp,0))||0}),[i]),b=s=>{if(!s)return null;const t={basico:"bg-emerald-100 text-emerald-800",medio:"bg-amber-100 text-amber-800",experto:"bg-rose-100 text-rose-800"},a=s==="basico"?"BÃ¡sico":s==="medio"?"Medio":"Experto";return e.jsx("span",{className:`text-[10px] px-2 py-1 rounded ${t[s]}`,children:a})};return e.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[e.jsxs("header",{className:"mb-10 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-black mb-3",children:"ðŸŽ“ Lecciones CONNECT Mayor"}),e.jsx("p",{className:"text-slate-600 max-w-2xl mx-auto",children:"Aprende tecnologÃ­a paso a paso. Un programa estructurado desde conceptos bÃ¡sicos hasta habilidades avanzadas."})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-10",children:[e.jsxs(c,{className:"relative overflow-hidden rounded-2xl py-6 text-center",children:[e.jsx("div",{className:"text-3xl font-black",children:o.niveles}),e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-600",children:"Niveles"})]}),e.jsxs(c,{className:"relative overflow-hidden rounded-2xl py-6 text-center",children:[e.jsx("div",{className:"text-3xl font-black",children:o.temas}),e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-600",children:"Temas"})]}),e.jsxs(c,{className:"relative overflow-hidden rounded-2xl py-6 text-center",children:[e.jsx("div",{className:"text-3xl font-black text-violet-600",children:o.lecciones}),e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-600",children:"Lecciones"})]}),e.jsxs(c,{className:"relative overflow-hidden rounded-2xl py-6 text-center",children:[e.jsxs("div",{className:"text-3xl font-black flex items-center justify-center gap-1",children:[e.jsx("span",{className:"text-amber-500",children:"âš¡"}),o.xp,"+"]}),e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-600",children:"XP Total"})]})]}),e.jsx("div",{className:"space-y-6",children:v.map(s=>{const t=j[s.id];return e.jsxs("div",{className:"rounded-2xl bg-white shadow-sm border overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>N(s.id),className:"w-full relative text-left group","aria-expanded":t,children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${s.gradient} opacity-90`}),e.jsxs("div",{className:"relative p-6 text-white flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[s.icon," ",s.title]}),e.jsx("p",{className:"text-xs opacity-90 max-w-lg",children:s.description})]}),e.jsxs("div",{className:"text-right text-xs font-medium",children:[e.jsxs("div",{className:"text-lg font-semibold",children:[s.percent,"%"]}),e.jsxs("div",{className:"opacity-80",children:[s.completed,"/",s.lessons," lecciones"]})]})]}),e.jsx(E,{value:s.percent,className:"h-2 bg-white/30"}),e.jsxs("div",{className:"flex items-center justify-between text-[11px]",children:[e.jsxs("span",{className:"opacity-80",children:["XP Total: ",s.xpTotal]}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[t?"Ocultar":"Ver"," lecciones ",e.jsx("span",{children:t?"â–²":"â–¼"})]})]})]})]}),e.jsx("div",{className:`transition-all duration-300 ${t?"max-h-[4000px] opacity-100":"max-h-0 opacity-0 pointer-events-none"} bg-gradient-to-b from-slate-50 to-white`,children:e.jsxs("div",{className:"p-6 grid sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[d[s.id].length===0&&e.jsx("div",{className:"col-span-full text-center text-slate-500 text-sm",children:"No hay lecciones en este nivel todavÃ­a."}),d[s.id].map(a=>{const r=x.has(a.id),m=r?100:0;return e.jsxs(c,{className:"flex flex-col justify-between rounded-2xl p-5 shadow-md hover:shadow-lg relative",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-lg font-extrabold text-blue-700 leading-tight",children:a.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[b(a.level),e.jsxs("span",{className:"text-[11px] bg-indigo-100 text-indigo-700 px-2 py-1 rounded",children:[a.xp," XP"]})]})]}),e.jsxs("div",{className:"grid grid-cols-[auto,1fr] gap-3 items-start",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-50 grid place-items-center text-lg","aria-hidden":!0,children:"ðŸ“˜"}),a.description&&e.jsx(B,{children:a.description})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex items-center text-[11px] px-2 py-1 rounded-full ${r?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:r?"âœ” Completada":"Pendiente"}),e.jsxs("span",{className:"text-[11px] text-slate-500",children:[m,"%"]})]}),e.jsx(M,{to:`/lessons/${a.id}`,children:e.jsx(C,{variant:r?"ghost":"primary",className:"text-xs px-4 py-2",children:r?"Revisar":"Abrir"})})]})]},a.id)})]})})]},s.id)})})]})}export{F as default};
